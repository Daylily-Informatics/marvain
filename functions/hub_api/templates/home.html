{% extends "base.html" %}

{% block title %}Home - Marvain{% endblock %}

{% block content %}
<div class="mb-lg">
  <h1>Welcome{% if user.email %}, {{ user.email.split('@')[0] }}{% endif %}</h1>
  <p class="text-muted">Your Marvain hub at a glance</p>
</div>

<!-- Quick Stats -->
<div class="grid grid-4 mb-lg">
  <a href="{{ url_for('gui_devices') }}" class="stat-card">
    <div class="card-icon info">
      <i class="fas fa-microchip"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ devices_count }}</div>
      <div class="stat-label">Devices</div>
    </div>
  </a>
  
  <a href="{{ url_for('gui_agents') }}" class="stat-card">
    <div class="card-icon highlight">
      <i class="fas fa-robot"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ agents_count }}</div>
      <div class="stat-label">Agents</div>
    </div>
  </a>
  
  <a href="{{ url_for('gui_spaces') }}" class="stat-card">
    <div class="card-icon info">
      <i class="fas fa-door-open"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ spaces_count }}</div>
      <div class="stat-label">Spaces</div>
    </div>
  </a>
  
  <a href="{{ url_for('gui_actions') }}" class="stat-card">
    <div class="card-icon {% if pending_actions > 0 %}warning{% else %}success{% endif %}">
      <i class="fas fa-tasks"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ pending_actions }}</div>
      <div class="stat-label">Pending Actions</div>
    </div>
  </a>
</div>

<!-- Two Column Layout -->
<div class="grid grid-2">
  <!-- Devices -->
  <div class="card">
    <div class="card-header">
      <h3 class="card-title"><i class="fas fa-microchip"></i> Devices</h3>
      <a href="{{ url_for('gui_devices') }}" class="btn btn-outline btn-sm">View All</a>
    </div>
    <div class="card-body">
      {% if devices %}
        <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
          {% for device in devices[:5] %}
          <a href="{{ url_for('gui_device_detail', device_id=device.device_id) }}"
             style="display: flex; align-items: center; justify-content: space-between; padding: var(--spacing-sm); background: var(--color-gray-700); border-radius: var(--radius-sm); text-decoration: none; color: inherit;">
            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
              <i class="fas fa-microchip" style="color: var(--color-info);"></i>
              <span>{{ device.name }}</span>
            </div>
            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
              <span class="badge badge-info">{{ device.agent_name }}</span>
              {% if device.revoked %}
                <span class="badge badge-error">Revoked</span>
              {% endif %}
            </div>
          </a>
          {% endfor %}
        </div>
      {% else %}
        <div class="empty-state">
          <div class="empty-state-icon"><i class="fas fa-microchip"></i></div>
          <p>No devices registered yet</p>
          <a href="{{ url_for('gui_devices') }}" class="btn btn-primary btn-sm">Add Device</a>
        </div>
      {% endif %}
    </div>
  </div>
  
  <!-- Your Agents -->
  <div class="card">
    <div class="card-header">
      <h3 class="card-title"><i class="fas fa-robot"></i> Your Agents</h3>
      <a href="{{ url_for('gui_agents') }}" class="btn btn-outline btn-sm">View All</a>
    </div>
    <div class="card-body">
      {% if agents %}
        <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
          {% for agent in agents[:5] %}
          <a href="{{ url_for('gui_agent_detail', agent_id=agent.agent_id) }}" 
             style="display: flex; align-items: center; justify-content: space-between; padding: var(--spacing-sm); background: var(--color-gray-700); border-radius: var(--radius-sm); text-decoration: none; color: inherit;">
            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
              <i class="fas fa-robot" style="color: var(--color-highlight);"></i>
              <span>{{ agent.name }}</span>
            </div>
            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
              <span class="badge badge-info">{{ agent.role }}</span>
              {% if agent.disabled %}
                <span class="badge badge-error">Disabled</span>
              {% endif %}
            </div>
          </a>
          {% endfor %}
        </div>
      {% else %}
        <div class="empty-state">
          <div class="empty-state-icon"><i class="fas fa-robot"></i></div>
          <p>No agents available</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div class="card" style="margin-top: var(--spacing-lg);">
  <div class="card-header">
    <h3 class="card-title"><i class="fas fa-bolt"></i> Quick Actions</h3>
  </div>
  <div class="card-body">
    <div style="display: flex; gap: var(--spacing-md); flex-wrap: wrap;">
      <a href="{{ url_for('gui_devices') }}" class="btn btn-outline">
        <i class="fas fa-microchip"></i> Manage Devices
      </a>
      <a href="{{ url_for('gui_livekit_test') }}" class="btn btn-outline">
        <i class="fas fa-video"></i> LiveKit Test
      </a>
      <a href="{{ url_for('gui_actions') }}" class="btn btn-outline">
        <i class="fas fa-check-circle"></i> Review Actions
      </a>
      <a href="{{ url_for('gui_events') }}" class="btn btn-outline">
        <i class="fas fa-stream"></i> Event Stream
      </a>
      <a href="{{ url_for('gui_memories') }}" class="btn btn-outline">
        <i class="fas fa-brain"></i> Memories
      </a>
      <a href="{{ url_for('gui_audit') }}" class="btn btn-outline">
        <i class="fas fa-shield-alt"></i> Audit Log
      </a>
      <a href="{{ url_for('gui_people') }}" class="btn btn-outline">
        <i class="fas fa-users"></i> People &amp; Consent
      </a>
    </div>
  </div>
</div>
{% endblock %}

